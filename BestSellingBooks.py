import streamlit as st
import pandas as pd
import pickle


#mapping dictionary for datasets

publisheddate_mapping 
  {
           4: '1304', 26: '1788', 75: '1791', 24: '1813', 2: '1859', 22: '1869', 32: '1877', 10: '1880', 70: '1881', 81: '1885', 76: '1887',
           77: '1899', 78: '1902', 83: '1908', 85: '1923', 67: '1925', 33: '1929', 7: '1932', 63: '1933', 47: '1934', 36: '1935', 28: '1936', 
           13: '1937', 6: '1938', 60: '1939', 55: '1942', 52: '1943', 56: '1945', 34: '1946', 12: '1947', 50: '1948', 49: '1949', 11: '1950', 
           40: '1951', 59: '1952', 69: '1953', 17: '1955', 5: '1956', 8: '1957', 29: '1958', 57: '1960', 80: '1961', 46: '1962', 21: '1963', 15: '1964', 
           23: '1965', 31: '1966', 87: '1967', 86: '1968', 41: '1969', 27: '1970', 1: '1971', 19: '1972', 68: '1973', 20: '1974', 71: '1975', 
           90: '1976', 92: '1977', 88: '1978', 38: '1979', 16: '1980', 54: '1981', 39: '1982', 82: '1984', 51: '1985', 65: '1986', 
           9: '1987', 62: '1988', 3: '1989', 14: '1991', 43: '1992', 84: '1993', 53: '1994', 45: '1995', 44: '1996', 48: '1997', 94: '1998', 61: '1999', 
           73: '2000', 91: '2001', 89: '2002', 72: '2003', 25: '2004', 64: '2005', 79: '2006', 18: '2007', 42: '2008', 37: '2009', 66: '2010', 30: '2011', 
           0: '2012', 58: '2014', 93: '2015', 35: '2016', 74: '2018'
  }


st.write("""
# Best Selling Books App

This app predicts the **Best Selling Books** type!
""")

st.image('BookShelf.jpeg')

st.sidebar.header('User Input Parameters')

def user_input_features():
    Authors = st.sidebar.selectbox('Authors Name',[ 22,   9,  58,   0,  17,  60,  16,  51, 146,  26, 115,  57, 126,
        87,  89,  47, 148,  72,  14,  90,   6, 144,  61, 121, 132,  33,
        59,  13, 122,  38,  35,  52, 145,  18,  78,  69, 108,  86,  19,
         7, 149,  24, 124,  85,  62,  15,  25,  44,  93,  28,  48, 150,
       136, 139, 125,   3, 133, 134,  63,  55,  84, 135, 103,  65,  74,
       114, 151, 131,  96,  41,  12,  56, 111,  49,  40,  21,  23,  71,
       153, 116, 128,  95,  10,  98, 137,  66, 142,  68, 100, 109, 120,
        39,  45,  30,  29, 141,  99, 107,  94, 101,   8,  34, 129, 130,
        64,  67,  83, 113,  75,  20,  70, 102,  31, 104,  43, 138,  91,
       106,  42, 119,  50,  88,  76,  53,   1, 110, 147,  27,  81,  73,
       152,  79,  11,  32,   5,  82,  77,   4,  80, 143,  36, 156,  92,
       140, 154, 123, 117,   2, 127,  97, 155, 112,  37, 118,  46, 105,
        54])
    Original_language = st.sidebar.selectbox('Original Language', [ 3,  4,  0,  7, 11, 13,  5,  8, 10, 12,  2, 14,  9,  1, 15,  6])
    First_Published = st.sidebar.selectbox('First Published', [ 4, 26, 75, 24,  2, 22, 32, 10, 70, 81, 76, 77, 78, 83, 85, 67, 33,
        7, 63, 47, 36, 28, 13,  6, 60, 55, 52, 56, 34, 12, 50, 49, 11, 40,
       59, 69, 17,  5,  8, 29, 57, 80, 46, 21, 15, 23, 31, 87, 86, 41, 27,
        1, 19, 68, 20, 71, 90, 92, 88, 38, 16, 54, 39, 82, 51, 65,  9, 62,
        3, 14, 43, 84, 53, 45, 44, 48, 94, 61, 73, 91, 89, 72, 25, 64, 79,
       18, 42, 37, 66, 30,  0, 58, 93, 35, 74])
    Genre = st.sidebar.selectbox('Genre', [ 4, 26, 75, 24,  2, 22, 32, 10, 70, 81, 76, 77, 78, 83, 85, 67, 33,
        7, 63, 47, 36, 28, 13,  6, 60, 55, 52, 56, 34, 12, 50, 49, 11, 40,
       59, 69, 17,  5,  8, 29, 57, 80, 46, 21, 15, 23, 31, 87, 86, 41, 27,
        1, 19, 68, 20, 71, 90, 92, 88, 38, 16, 54, 39, 82, 51, 65,  9, 62,
        3, 14, 43, 84, 53, 45, 44, 48, 94, 61, 73, 91, 89, 72, 25, 64, 79,
       18, 42, 37, 66, 30,  0, 58, 93, 35, 74]) 
    data = {'Authors': Authors,
            'Original_language': Original_language,
            'First_Published': First_Published,
            'Genre': Genre}
    features = pd.DataFrame(data, index=[0])
    return features

df = user_input_features()

st.subheader('User Input parameters')
st.write(df)

loaded_model = pickle.load(open("Best_Selling_Bookss.h5", "rb"))

prediction = loaded_model.predict(df)

st.subheader('Prediction')
st.write(prediction)
